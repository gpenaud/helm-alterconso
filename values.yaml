nameOverride: ""
fullnameOverride: ""

app:
  # -------------------------------------------------------------------------- #
  #                           application configuration                        #
  # -------------------------------------------------------------------------- #
  configuration:
    webapp:
      vhost: cagette-alterconso.happynuts.me
      sql_log_enabled: false
      debug_enabled: true
      mailer_host: localhost
      mailer_port: 5000
      mysql_enabled: true
      mysql_user: docker
      mysql_password: docker
      mysql_host: localhost
      mysql_port: 3306
      mysql_database: db

  # -------------------------------------------------------------------------- #
  #                           containers configuration                         #
  # -------------------------------------------------------------------------- #
  containers:

    webapp:
      replicaCount: 1
      image:
        repository: cagette
        pullPolicy: IfNotPresent
        tag: "1.0.0"
      imagePullSecrets: []
      # podSecurityContext:
      #   runAsNonRoot: true
      #   runAsUser: 1000
      # We want to inject env vars in our container app.
      ports:
        - containerPort: 80
          protocol: TCP
      resources:
        limits:
          cpu: 500m
          memory: 256Mi
        requests:
          cpu: 250m
          memory: 128Mi
    # ------------------------------------------------------------------------ #
    #                                   Mailer                                 #
    # ------------------------------------------------------------------------ #
    mailer:
      replicaCount: 1
      image:
        repository: cagette-mailer
        pullPolicy: IfNotPresent
        tag: "1.0.0"
      imagePullSecrets: []
      ports:
        - name: mailer
          containerPort: 5000
          protocol: TCP
      resources:
        limits:
          cpu: 100m
          memory: 128Mi
        requests:
          cpu: 50m
          memory: 64Mi
      env:
        # smtp relay configuration
        SMTP_HOST: smtp.gmail.com
        SMTP_PORT: 587
        SMTP_USER: PLACEHOLDER
        SMTP_PASSWORD: PLACEHOLDER
  # initContainers:
  #   - name: check-db-ready
  #     image: postgres:9.6.5
  #     command:
  #       - 'sh'
  #       - '-c'
  #       - 'until pg_isready -h windforlife-postgresql -p 5432; do echo waiting for database; sleep 2; done;'
  serviceAccount:
    create: true
    name: ""
  service:
    type: ClusterIP
    port: 80
  ingress:
    enabled: true
    className: ""
    annotations:
      kubernetes.io/ingress.class: "nginx"
      kubernetes.io/tls-acme: "true"
      cert-manager.io/issuer: "letsencrypt-production-issuer"
      cert-manager.io/issue-temporary-certificate: "true"
      acme.cert-manager.io/http01-edit-in-place: "true"
    hosts:
      - host: cagette-alterconso.happynuts.me
        paths:
          - path: /
            pathType: Prefix
    tls:
      - hosts:
        - cagette-alterconso.happynuts.me
        secretName: cagette-alterconso.happynuts.me-tls
  autoscaling:
    enabled: true
    minReplicas: 1
    maxReplicas: 4
    targetCPUUtilizationPercentage: 90
    targetMemoryUtilizationPercentage: 90

mysql:
  enabled: true
